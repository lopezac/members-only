extends layout

block content
  block main
  block messages
    if messages.length
      h2 Messages
      section
        each msg in messages
          - const isMember = () => currentUser && currentUser.membership;
          - const isUserMsg = () => currentUser && msg.user._id.toString() == currentUser._id.toString();
          - const isAdmin = () => currentUser && currentUser.isAdmin;
          article
            h3
              a(href=msg.url)= msg.title
            if isUserMsg() || isMember() || isAdmin()
              p 
                a(href=msg.user.url) #{msg.user.fullName} @#{msg.user.username}
              p= msg.timestampFormat
            else
              p Private author
              p Private timestamp
            p= msg.text
    else
      h2 No messages yet